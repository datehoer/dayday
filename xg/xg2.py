import wave
import math
import struct
ff=wave.open("v1.wav","w")
ff.setframerate(8000)
ff.setnchannels(1)
ff.setsampwidth(2)
  
  
def wv(t=0,f=0,v=0.5,wf=ff,sr=8000):
    '''
    t:写入时长
    f:声音频率
    v：音量
    wf：一个可以写入的音频文件
    sr：采样率
    '''
    tt=0
    dt=1.0/sr
    while tt<=t:
        s=math.cos(tt*math.pi*2*f)*v*32768 #采样，调节音量，映射到[-2^15,2^15)
        s=int(s)
        fd=struct.pack("h",s) #转换成8bit二进制数据
        wf.writeframes(fd) #写入音频文件
        tt+=dt #时间流逝
  
note={  "1-":220,"2-":246.94,"3-":227.19,"4-":293.67,"5-":329.67,"6-":329.63,"7-":415.31,
        "1":440,"2":493.88,"3":554.37,"4":587.33,"5":659.33,"6":739.99,"7":830.61,
        "1+":880,"2+":987.76,"3+":1108.74,"4+":1174.66,"5+":1318.66,"6+":1479.98,"7+":1661.22,"0":0
}
n=[
        "6","0","6","0","6","0","6","3","6","7","1+","0","1+","0","1+","0",
        "1+","2+","5","4","3","0","2","0",
        "6","0","6","0","6","0","6","3","6","7","1+","0","1+","0","1+","0",
        "1+","2+","5","0","3","0","4","0","5","0","6","0","7","0",
        "1+","0","1+","0","1+","0","1+","6","1+","3+","0","4+","0","4+","0","4+","0",
        "4+","1+","3+","0","5","7","0","1+","0","2+","0","1+","0","7","0",
        "1+","0","1+","0","1+","0","1+","6","1+","3+","0","4+","0","4+","0","4+","0",
        "5+","0","4+","0","3+","1+","0","5","1+","3+","2+","0","2+","0","2+","0","3+","0","3+","0",
]
 
interal={
        0:0.02,1:0.1875,2:0.375,3:0.5625,4:0.75,5:0.9375,6:1.125
}
#   1拍--0.1875   2拍--0.375    3拍--0.5625   4拍--0.75
tm=[
        3,0,1,0,5,0,1,1,1,1,3,0,1,0,5,0,
        2,2,5,4,4,0,6,4,
        3,0,1,0,5,0,1,1,1,1,3,0,1,0,5,0,
        2,2,5,2,2,0,2,0,2,0,5,0,5,0,
        3,0,1,0,5,0,1,1,1,1,0,3,0,1,0,5,0,
        2,2,5,2,2,2,0,2,0,5,0,4,0,4,0,
        3,0,1,0,5,0,1,1,1,1,0,3,0,1,0,5,0,
        2,0,2,0,4,4,2,2,2,2,5,0,1,0,1,0,2,0,5,0,
]
for i in range(len(n)):
    wv(interal[tm[i]],note[n[i]])
  
ff.close()
